module.exports=[57532,a=>a.a(async(b,c)=>{try{var d=a.i(37936),e=a.i(66518),f=a.i(18558);a.i(70396);var g=a.i(73727),h=a.i(53112),i=a.i(13095),j=b([e]);[e]=j.then?(await j)():j;let n=h.z.object({name:h.z.string().min(1,"Name is required"),email:h.z.string().email("Valid email is required"),type:h.z.enum(["FOUNDER","EMPLOYEE","INVESTOR","ADVISOR","BOARD_MEMBER","CONSULTANT"]),title:h.z.string().optional()});async function k(a,b){let c=await e.prisma.company.findFirst();if(!c)return{errors:{_form:["No company found. Please create a company first."]}};let d=n.safeParse({name:b.get("name"),email:b.get("email"),type:b.get("type"),title:b.get("title")||void 0});if(!d.success)return{errors:d.error.flatten().fieldErrors};let{name:h,email:i,type:j,title:k}=d.data;try{if(await e.prisma.stakeholder.findUnique({where:{companyId_email:{companyId:c.id,email:i.toLowerCase()}}}))return{errors:{email:["A stakeholder with this email already exists"]}};await e.prisma.stakeholder.create({data:{companyId:c.id,name:h,email:i.toLowerCase(),type:j,title:k||null}})}catch(a){return console.error("Error creating stakeholder:",a),{errors:{_form:["Failed to create stakeholder"]}}}(0,f.revalidatePath)("/stakeholders"),(0,g.redirect)("/stakeholders")}async function l(a,b){let c=b.get("id"),d=n.safeParse({name:b.get("name"),email:b.get("email"),type:b.get("type"),title:b.get("title")||void 0});if(!d.success)return{errors:d.error.flatten().fieldErrors};let{name:h,email:i,type:j,title:k}=d.data;try{let a=await e.prisma.stakeholder.findUnique({where:{id:c}});if(!a)return{errors:{_form:["Stakeholder not found"]}};if(i.toLowerCase()!==a.email.toLowerCase()&&await e.prisma.stakeholder.findUnique({where:{companyId_email:{companyId:a.companyId,email:i.toLowerCase()}}}))return{errors:{email:["A stakeholder with this email already exists"]}};await e.prisma.stakeholder.update({where:{id:c},data:{name:h,email:i.toLowerCase(),type:j,title:k||null}})}catch(a){return console.error("Error updating stakeholder:",a),{errors:{_form:["Failed to update stakeholder"]}}}(0,f.revalidatePath)("/stakeholders"),(0,f.revalidatePath)(`/stakeholders/${c}`),(0,g.redirect)("/stakeholders")}async function m(a){try{let b=await e.prisma.stakeholder.findUnique({where:{id:a},include:{_count:{select:{shareCertificates:!0,optionGrants:!0,convertibles:!0}}}});if(!b)return{error:"Stakeholder not found"};let c=b._count.shareCertificates+b._count.optionGrants+b._count.convertibles;if(c>0)return{error:`Cannot delete stakeholder with existing securities (${c} total)`};return await e.prisma.stakeholder.delete({where:{id:a}}),(0,f.revalidatePath)("/stakeholders"),{}}catch(a){return console.error("Error deleting stakeholder:",a),{error:"Failed to delete stakeholder"}}}(0,i.ensureServerEntryExports)([k,l,m]),(0,d.registerServerReference)(k,"60052f4015a36bcdcded7a564a728882354e5a3e6d",null),(0,d.registerServerReference)(l,"607ec0d706f006711626daf81fbfc131e2a247a5f0",null),(0,d.registerServerReference)(m,"400f716d2c882d213d4a4500ed4b5c7f1ce60bad97",null),a.s(["createStakeholder",()=>k,"updateStakeholder",()=>l]),c()}catch(a){c(a)}},!1),15188,a=>a.a(async(b,c)=>{try{var d=a.i(57532),e=b([d]);[d]=e.then?(await e)():e,a.s([]),c()}catch(a){c(a)}},!1),25100,a=>a.a(async(b,c)=>{try{var d=a.i(15188),e=a.i(57532),f=b([d,e]);[d,e]=f.then?(await f)():f,a.s(["60052f4015a36bcdcded7a564a728882354e5a3e6d",()=>e.createStakeholder,"607ec0d706f006711626daf81fbfc131e2a247a5f0",()=>e.updateStakeholder]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_13e49df2._.js.map