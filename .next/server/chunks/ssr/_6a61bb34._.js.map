{"version":3,"sources":["../../../../node_modules/date-fns/constants.js","../../../../node_modules/date-fns/constructFrom.js","../../../../node_modules/date-fns/toDate.js","../../../../node_modules/date-fns/addMonths.js","../../../../node_modules/date-fns/_lib/normalizeDates.js","../../../../node_modules/date-fns/startOfDay.js","../../../../node_modules/date-fns/differenceInDays.js","../../../../node_modules/date-fns/_lib/getTimezoneOffsetInMilliseconds.js","../../../../node_modules/date-fns/differenceInCalendarDays.js","../../../../node_modules/date-fns/isBefore.js","../../../../node_modules/date-fns/isAfter.js","../../../../node_modules/date-fns/isSameDay.js","../../../../src/lib/calculations.ts"],"sourcesContent":["/**\n * @module constants\n * @summary Useful constants\n * @description\n * Collection of useful date constants.\n *\n * The constants could be imported from `date-fns/constants`:\n *\n * ```ts\n * import { maxTime, minTime } from \"./constants/date-fns/constants\";\n *\n * function isAllowedTime(time) {\n *   return time <= maxTime && time >= minTime;\n * }\n * ```\n */\n\n/**\n * @constant\n * @name daysInWeek\n * @summary Days in 1 week.\n */\nexport const daysInWeek = 7;\n\n/**\n * @constant\n * @name daysInYear\n * @summary Days in 1 year.\n *\n * @description\n * How many days in a year.\n *\n * One years equals 365.2425 days according to the formula:\n *\n * > Leap year occurs every 4 years, except for years that are divisible by 100 and not divisible by 400.\n * > 1 mean year = (365+1/4-1/100+1/400) days = 365.2425 days\n */\nexport const daysInYear = 365.2425;\n\n/**\n * @constant\n * @name maxTime\n * @summary Maximum allowed time.\n *\n * @example\n * import { maxTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = 8640000000000001 <= maxTime;\n * //=> false\n *\n * new Date(8640000000000001);\n * //=> Invalid Date\n */\nexport const maxTime = Math.pow(10, 8) * 24 * 60 * 60 * 1000;\n\n/**\n * @constant\n * @name minTime\n * @summary Minimum allowed time.\n *\n * @example\n * import { minTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = -8640000000000001 >= minTime;\n * //=> false\n *\n * new Date(-8640000000000001)\n * //=> Invalid Date\n */\nexport const minTime = -maxTime;\n\n/**\n * @constant\n * @name millisecondsInWeek\n * @summary Milliseconds in 1 week.\n */\nexport const millisecondsInWeek = 604800000;\n\n/**\n * @constant\n * @name millisecondsInDay\n * @summary Milliseconds in 1 day.\n */\nexport const millisecondsInDay = 86400000;\n\n/**\n * @constant\n * @name millisecondsInMinute\n * @summary Milliseconds in 1 minute\n */\nexport const millisecondsInMinute = 60000;\n\n/**\n * @constant\n * @name millisecondsInHour\n * @summary Milliseconds in 1 hour\n */\nexport const millisecondsInHour = 3600000;\n\n/**\n * @constant\n * @name millisecondsInSecond\n * @summary Milliseconds in 1 second\n */\nexport const millisecondsInSecond = 1000;\n\n/**\n * @constant\n * @name minutesInYear\n * @summary Minutes in 1 year.\n */\nexport const minutesInYear = 525600;\n\n/**\n * @constant\n * @name minutesInMonth\n * @summary Minutes in 1 month.\n */\nexport const minutesInMonth = 43200;\n\n/**\n * @constant\n * @name minutesInDay\n * @summary Minutes in 1 day.\n */\nexport const minutesInDay = 1440;\n\n/**\n * @constant\n * @name minutesInHour\n * @summary Minutes in 1 hour.\n */\nexport const minutesInHour = 60;\n\n/**\n * @constant\n * @name monthsInQuarter\n * @summary Months in 1 quarter.\n */\nexport const monthsInQuarter = 3;\n\n/**\n * @constant\n * @name monthsInYear\n * @summary Months in 1 year.\n */\nexport const monthsInYear = 12;\n\n/**\n * @constant\n * @name quartersInYear\n * @summary Quarters in 1 year\n */\nexport const quartersInYear = 4;\n\n/**\n * @constant\n * @name secondsInHour\n * @summary Seconds in 1 hour.\n */\nexport const secondsInHour = 3600;\n\n/**\n * @constant\n * @name secondsInMinute\n * @summary Seconds in 1 minute.\n */\nexport const secondsInMinute = 60;\n\n/**\n * @constant\n * @name secondsInDay\n * @summary Seconds in 1 day.\n */\nexport const secondsInDay = secondsInHour * 24;\n\n/**\n * @constant\n * @name secondsInWeek\n * @summary Seconds in 1 week.\n */\nexport const secondsInWeek = secondsInDay * 7;\n\n/**\n * @constant\n * @name secondsInYear\n * @summary Seconds in 1 year.\n */\nexport const secondsInYear = secondsInDay * daysInYear;\n\n/**\n * @constant\n * @name secondsInMonth\n * @summary Seconds in 1 month\n */\nexport const secondsInMonth = secondsInYear / 12;\n\n/**\n * @constant\n * @name secondsInQuarter\n * @summary Seconds in 1 quarter.\n */\nexport const secondsInQuarter = secondsInMonth * 3;\n\n/**\n * @constant\n * @name constructFromSymbol\n * @summary Symbol enabling Date extensions to inherit properties from the reference date.\n *\n * The symbol is used to enable the `constructFrom` function to construct a date\n * using a reference date and a value. It allows to transfer extra properties\n * from the reference date to the new date. It's useful for extensions like\n * [`TZDate`](https://github.com/date-fns/tz) that accept a time zone as\n * a constructor argument.\n */\nexport const constructFromSymbol = Symbol.for(\"constructDateFrom\");\n","import { constructFromSymbol } from \"./constants.js\";\n\n/**\n * @name constructFrom\n * @category Generic Helpers\n * @summary Constructs a date using the reference date and the value\n *\n * @description\n * The function constructs a new date using the constructor from the reference\n * date and the given value. It helps to build generic functions that accept\n * date extensions.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * Starting from v3.7.0, it allows to construct a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The reference date to take constructor from\n * @param value - The value to create the date\n *\n * @returns Date initialized using the given date and value\n *\n * @example\n * import { constructFrom } from \"./constructFrom/date-fns\";\n *\n * // A function that clones a date preserving the original type\n * function cloneDate<DateType extends Date>(date: DateType): DateType {\n *   return constructFrom(\n *     date, // Use constructor from the given date\n *     date.getTime() // Use the date value to create a new date\n *   );\n * }\n */\nexport function constructFrom(date, value) {\n  if (typeof date === \"function\") return date(value);\n\n  if (date && typeof date === \"object\" && constructFromSymbol in date)\n    return date[constructFromSymbol](value);\n\n  if (date instanceof Date) return new date.constructor(value);\n\n  return new Date(value);\n}\n\n// Fallback for modularized imports:\nexport default constructFrom;\n","import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * Starting from v3.7.0, it clones a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param argument - The value to convert\n *\n * @returns The parsed date in the local time zone\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\nexport function toDate(argument, context) {\n  // [TODO] Get rid of `toDate` or `constructFrom`?\n  return constructFrom(context || argument, argument);\n}\n\n// Fallback for modularized imports:\nexport default toDate;\n","import { constructFrom } from \"./constructFrom.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link addMonths} function options.\n */\n\n/**\n * @name addMonths\n * @category Month Helpers\n * @summary Add the specified number of months to the given date.\n *\n * @description\n * Add the specified number of months to the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param amount - The amount of months to be added.\n * @param options - The options object\n *\n * @returns The new date with the months added\n *\n * @example\n * // Add 5 months to 1 September 2014:\n * const result = addMonths(new Date(2014, 8, 1), 5)\n * //=> Sun Feb 01 2015 00:00:00\n *\n * // Add one month to 30 January 2023:\n * const result = addMonths(new Date(2023, 0, 30), 1)\n * //=> Tue Feb 28 2023 00:00:00\n */\nexport function addMonths(date, amount, options) {\n  const _date = toDate(date, options?.in);\n  if (isNaN(amount)) return constructFrom(options?.in || date, NaN);\n  if (!amount) {\n    // If 0 months, no-op to avoid changing times in the hour before end of DST\n    return _date;\n  }\n  const dayOfMonth = _date.getDate();\n\n  // The JS Date object supports date math by accepting out-of-bounds values for\n  // month, day, etc. For example, new Date(2020, 0, 0) returns 31 Dec 2019 and\n  // new Date(2020, 13, 1) returns 1 Feb 2021.  This is *almost* the behavior we\n  // want except that dates will wrap around the end of a month, meaning that\n  // new Date(2020, 13, 31) will return 3 Mar 2021 not 28 Feb 2021 as desired. So\n  // we'll default to the end of the desired month by adding 1 to the desired\n  // month and using a date of 0 to back up one day to the end of the desired\n  // month.\n  const endOfDesiredMonth = constructFrom(options?.in || date, _date.getTime());\n  endOfDesiredMonth.setMonth(_date.getMonth() + amount + 1, 0);\n  const daysInMonth = endOfDesiredMonth.getDate();\n  if (dayOfMonth >= daysInMonth) {\n    // If we're already at the end of the month, then this is the correct date\n    // and we're done.\n    return endOfDesiredMonth;\n  } else {\n    // Otherwise, we now know that setting the original day-of-month value won't\n    // cause an overflow, so set the desired day-of-month. Note that we can't\n    // just set the date of `endOfDesiredMonth` because that object may have had\n    // its time changed in the unusual case where where a DST transition was on\n    // the last day of the month and its local time was in the hour skipped or\n    // repeated next to a DST transition.  So we use `date` instead which is\n    // guaranteed to still have the original time.\n    _date.setFullYear(\n      endOfDesiredMonth.getFullYear(),\n      endOfDesiredMonth.getMonth(),\n      dayOfMonth,\n    );\n    return _date;\n  }\n}\n\n// Fallback for modularized imports:\nexport default addMonths;\n","import { constructFrom } from \"../constructFrom.js\";\n\nexport function normalizeDates(context, ...dates) {\n  const normalize = constructFrom.bind(\n    null,\n    context || dates.find((date) => typeof date === \"object\"),\n  );\n  return dates.map(normalize);\n}\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link startOfDay} function options.\n */\n\n/**\n * @name startOfDay\n * @category Day Helpers\n * @summary Return the start of a day for the given date.\n *\n * @description\n * Return the start of a day for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - The options\n *\n * @returns The start of a day\n *\n * @example\n * // The start of a day for 2 September 2014 11:55:00:\n * const result = startOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 00:00:00\n */\nexport function startOfDay(date, options) {\n  const _date = toDate(date, options?.in);\n  _date.setHours(0, 0, 0, 0);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default startOfDay;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { differenceInCalendarDays } from \"./differenceInCalendarDays.js\";\n\n/**\n * The {@link differenceInDays} function options.\n */\n\n/**\n * @name differenceInDays\n * @category Day Helpers\n * @summary Get the number of full days between the given dates.\n *\n * @description\n * Get the number of full day periods between two dates. Fractional days are\n * truncated towards zero.\n *\n * One \"full day\" is the distance between a local time in one day to the same\n * local time on the next or previous day. A full day can sometimes be less than\n * or more than 24 hours if a daylight savings change happens between two dates.\n *\n * To ignore DST and only measure exact 24-hour periods, use this instead:\n * `Math.trunc(differenceInHours(dateLeft, dateRight)/24)|0`.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options\n *\n * @returns The number of full days according to the local timezone\n *\n * @example\n * // How many full days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 365\n *\n * @example\n * // How many full days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 0\n *\n * @example\n * // How many full days are between\n * // 1 March 2020 0:00 and 1 June 2020 0:00 ?\n * // Note: because local time is used, the\n * // result will always be 92 days, even in\n * // time zones where DST starts and the\n * // period has only 92*24-1 hours.\n * const result = differenceInDays(\n *   new Date(2020, 5, 1),\n *   new Date(2020, 2, 1)\n * )\n * //=> 92\n */\nexport function differenceInDays(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n\n  const sign = compareLocalAsc(laterDate_, earlierDate_);\n  const difference = Math.abs(\n    differenceInCalendarDays(laterDate_, earlierDate_),\n  );\n\n  laterDate_.setDate(laterDate_.getDate() - sign * difference);\n\n  // Math.abs(diff in full days - diff in calendar days) === 1 if last calendar day is not full\n  // If so, result must be decreased by 1 in absolute value\n  const isLastDayNotFull = Number(\n    compareLocalAsc(laterDate_, earlierDate_) === -sign,\n  );\n\n  const result = sign * (difference - isLastDayNotFull);\n  // Prevent negative zero\n  return result === 0 ? 0 : result;\n}\n\n// Like `compareAsc` but uses local time not UTC, which is needed\n// for accurate equality comparisons of UTC timestamps that end up\n// having the same representation in local time, e.g. one hour before\n// DST ends vs. the instant that DST ends.\nfunction compareLocalAsc(laterDate, earlierDate) {\n  const diff =\n    laterDate.getFullYear() - earlierDate.getFullYear() ||\n    laterDate.getMonth() - earlierDate.getMonth() ||\n    laterDate.getDate() - earlierDate.getDate() ||\n    laterDate.getHours() - earlierDate.getHours() ||\n    laterDate.getMinutes() - earlierDate.getMinutes() ||\n    laterDate.getSeconds() - earlierDate.getSeconds() ||\n    laterDate.getMilliseconds() - earlierDate.getMilliseconds();\n\n  if (diff < 0) return -1;\n  if (diff > 0) return 1;\n\n  // Return 0 if diff is 0; return NaN if diff is NaN\n  return diff;\n}\n\n// Fallback for modularized imports:\nexport default differenceInDays;\n","import { toDate } from \"../toDate.js\";\n\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\nexport function getTimezoneOffsetInMilliseconds(date) {\n  const _date = toDate(date);\n  const utcDate = new Date(\n    Date.UTC(\n      _date.getFullYear(),\n      _date.getMonth(),\n      _date.getDate(),\n      _date.getHours(),\n      _date.getMinutes(),\n      _date.getSeconds(),\n      _date.getMilliseconds(),\n    ),\n  );\n  utcDate.setUTCFullYear(_date.getFullYear());\n  return +date - +utcDate;\n}\n","import { getTimezoneOffsetInMilliseconds } from \"./_lib/getTimezoneOffsetInMilliseconds.js\";\nimport { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { millisecondsInDay } from \"./constants.js\";\nimport { startOfDay } from \"./startOfDay.js\";\n\n/**\n * The {@link differenceInCalendarDays} function options.\n */\n\n/**\n * @name differenceInCalendarDays\n * @category Day Helpers\n * @summary Get the number of calendar days between the given dates.\n *\n * @description\n * Get the number of calendar days between the given dates. This means that the times are removed\n * from the dates and then the difference in days is calculated.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - The options object\n *\n * @returns The number of calendar days\n *\n * @example\n * // How many calendar days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInCalendarDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 366\n * // How many calendar days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInCalendarDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 1\n */\nexport function differenceInCalendarDays(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n\n  const laterStartOfDay = startOfDay(laterDate_);\n  const earlierStartOfDay = startOfDay(earlierDate_);\n\n  const laterTimestamp =\n    +laterStartOfDay - getTimezoneOffsetInMilliseconds(laterStartOfDay);\n  const earlierTimestamp =\n    +earlierStartOfDay - getTimezoneOffsetInMilliseconds(earlierStartOfDay);\n\n  // Round the number of days to the nearest integer because the number of\n  // milliseconds in a day is not constant (e.g. it's different in the week of\n  // the daylight saving time clock shift).\n  return Math.round((laterTimestamp - earlierTimestamp) / millisecondsInDay);\n}\n\n// Fallback for modularized imports:\nexport default differenceInCalendarDays;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * @name isBefore\n * @category Common Helpers\n * @summary Is the first date before the second one?\n *\n * @description\n * Is the first date before the second one?\n *\n * @param date - The date that should be before the other one to return true\n * @param dateToCompare - The date to compare with\n *\n * @returns The first date is before the second date\n *\n * @example\n * // Is 10 July 1989 before 11 February 1987?\n * const result = isBefore(new Date(1989, 6, 10), new Date(1987, 1, 11))\n * //=> false\n */\nexport function isBefore(date, dateToCompare) {\n  return +toDate(date) < +toDate(dateToCompare);\n}\n\n// Fallback for modularized imports:\nexport default isBefore;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * @name isAfter\n * @category Common Helpers\n * @summary Is the first date after the second one?\n *\n * @description\n * Is the first date after the second one?\n *\n * @param date - The date that should be after the other one to return true\n * @param dateToCompare - The date to compare with\n *\n * @returns The first date is after the second date\n *\n * @example\n * // Is 10 July 1989 after 11 February 1987?\n * const result = isAfter(new Date(1989, 6, 10), new Date(1987, 1, 11))\n * //=> true\n */\nexport function isAfter(date, dateToCompare) {\n  return +toDate(date) > +toDate(dateToCompare);\n}\n\n// Fallback for modularized imports:\nexport default isAfter;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { startOfDay } from \"./startOfDay.js\";\n\n/**\n * The {@link isSameDay} function options.\n */\n\n/**\n * @name isSameDay\n * @category Day Helpers\n * @summary Are the given dates in the same day (and year and month)?\n *\n * @description\n * Are the given dates in the same day (and year and month)?\n *\n * @param laterDate - The first date to check\n * @param earlierDate - The second date to check\n * @param options - An object with options\n *\n * @returns The dates are in the same day (and year and month)\n *\n * @example\n * // Are 4 September 06:00:00 and 4 September 18:00:00 in the same day?\n * const result = isSameDay(new Date(2014, 8, 4, 6, 0), new Date(2014, 8, 4, 18, 0))\n * //=> true\n *\n * @example\n * // Are 4 September and 4 October in the same day?\n * const result = isSameDay(new Date(2014, 8, 4), new Date(2014, 9, 4))\n * //=> false\n *\n * @example\n * // Are 4 September, 2014 and 4 September, 2015 in the same day?\n * const result = isSameDay(new Date(2014, 8, 4), new Date(2015, 8, 4))\n * //=> false\n */\nexport function isSameDay(laterDate, earlierDate, options) {\n  const [dateLeft_, dateRight_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n  return +startOfDay(dateLeft_) === +startOfDay(dateRight_);\n}\n\n// Fallback for modularized imports:\nexport default isSameDay;\n","import { prisma } from \"./prisma\";\nimport {\n  addMonths,\n  differenceInDays,\n  isBefore,\n  isAfter,\n  isSameDay,\n  startOfDay,\n} from \"date-fns\";\nimport type {\n  ShareCertificate,\n  ShareClass,\n  OptionGrant,\n  VestingSchedule,\n  Convertible,\n  EquityPlan,\n  Stakeholder,\n} from \"@prisma/client\";\n\n// ============================================\n// TYPES\n// ============================================\n\nexport interface FullyDilutedBreakdown {\n  outstandingCommon: number;\n  outstandingPreferredAsConverted: number;\n  allOutstandingOptions: number;\n  availableOptionPool: number;\n  convertibleShares: number;\n  total: number;\n}\n\nexport interface StakeholderOwnership {\n  stakeholderId: string;\n  stakeholderName: string;\n  stakeholderType: string;\n  outstandingShares: number;\n  fullyDilutedShares: number;\n  outstandingPercent: number;\n  fullyDilutedPercent: number;\n  totalInvested: number;\n}\n\nexport interface ShareClassOwnership {\n  shareClassId: string;\n  shareClassName: string;\n  shareClassType: string;\n  outstandingShares: number;\n  fullyDilutedShares: number;\n  outstandingPercent: number;\n  fullyDilutedPercent: number;\n}\n\nexport interface VestingPeriodData {\n  periodNumber: number;\n  vestingDate: Date;\n  sharesVested: number;\n  cumulativeVested: number;\n}\n\n// ============================================\n// FULLY DILUTED CALCULATIONS\n// ============================================\n\nexport async function getFullyDilutedBreakdown(\n  companyId: string\n): Promise<FullyDilutedBreakdown> {\n  // 1. Outstanding common shares\n  const commonCerts = await prisma.shareCertificate.findMany({\n    where: {\n      companyId,\n      status: \"OUTSTANDING\",\n      shareClass: { type: \"COMMON\" },\n    },\n    include: { shareClass: true },\n  });\n  const outstandingCommon = commonCerts.reduce((sum, c) => sum + c.quantity, 0);\n\n  // 2. Outstanding preferred shares as-converted\n  const preferredCerts = await prisma.shareCertificate.findMany({\n    where: {\n      companyId,\n      status: \"OUTSTANDING\",\n      shareClass: { type: \"PREFERRED\" },\n    },\n    include: { shareClass: true },\n  });\n  const outstandingPreferredAsConverted = preferredCerts.reduce((sum, c) => {\n    const conversionRatio = Number(c.shareClass.conversionRatio);\n    return sum + Math.floor(c.quantity * conversionRatio);\n  }, 0);\n\n  // 3. All outstanding options (vested + unvested from active grants)\n  const activeGrants = await prisma.optionGrant.findMany({\n    where: {\n      companyId,\n      status: { in: [\"ACTIVE\", \"PARTIALLY_EXERCISED\"] },\n    },\n    include: { exercises: true },\n  });\n  const allOutstandingOptions = activeGrants.reduce((sum, g) => {\n    const exercised = g.exercises.reduce((e, ex) => e + ex.sharesExercised, 0);\n    return sum + (g.originalQuantity - exercised - g.expiredQuantity);\n  }, 0);\n\n  // 4. Available option pool\n  const equityPlans = await prisma.equityPlan.findMany({\n    where: { companyId },\n  });\n  const availableOptionPool = equityPlans.reduce(\n    (sum, p) => sum + p.availableShares,\n    0\n  );\n\n  // 5. Shares issuable on SAFE/CN conversion\n  const convertibles = await prisma.convertible.findMany({\n    where: { companyId, status: \"OUTSTANDING\" },\n  });\n  \n  // For conversion shares, we need company's last priced round or cap\n  const latestPreferredClass = await prisma.shareClass.findFirst({\n    where: { companyId, type: \"PREFERRED\" },\n    orderBy: { createdAt: \"desc\" },\n  });\n  \n  let convertibleShares = 0;\n  for (const conv of convertibles) {\n    const principal = Number(conv.principal);\n    const accrued = conv.type === \"CONVERTIBLE_NOTE\" \n      ? calculateAccruedInterest(conv)\n      : 0;\n    const totalAmount = principal + accrued;\n    \n    // Use valuation cap to determine shares, or latest preferred price\n    if (conv.valuationCap) {\n      const cap = Number(conv.valuationCap);\n      // Estimate shares based on cap and a standard fully diluted assumption\n      // This is a simplified calculation - real conversion happens at a priced round\n      const impliedPrice = cap / 10000000; // Simplified: assume 10M fully diluted\n      convertibleShares += Math.floor(totalAmount / impliedPrice);\n    } else if (latestPreferredClass) {\n      // Use latest preferred price with discount\n      const discount = conv.discount ? Number(conv.discount) : 0;\n      const price = Number(latestPreferredClass.pricePerShare) * (1 - discount);\n      if (price > 0) {\n        convertibleShares += Math.floor(totalAmount / price);\n      }\n    }\n  }\n\n  const total =\n    outstandingCommon +\n    outstandingPreferredAsConverted +\n    allOutstandingOptions +\n    availableOptionPool +\n    convertibleShares;\n\n  return {\n    outstandingCommon,\n    outstandingPreferredAsConverted,\n    allOutstandingOptions,\n    availableOptionPool,\n    convertibleShares,\n    total,\n  };\n}\n\nexport async function getFullyDilutedShares(companyId: string): Promise<number> {\n  const breakdown = await getFullyDilutedBreakdown(companyId);\n  return breakdown.total;\n}\n\nexport async function getTotalOutstandingShares(companyId: string): Promise<number> {\n  const certs = await prisma.shareCertificate.findMany({\n    where: { companyId, status: \"OUTSTANDING\" },\n  });\n  return certs.reduce((sum, c) => sum + c.quantity, 0);\n}\n\n// ============================================\n// OWNERSHIP CALCULATIONS\n// ============================================\n\nexport async function getOwnershipByStakeholder(\n  companyId: string\n): Promise<StakeholderOwnership[]> {\n  const stakeholders = await prisma.stakeholder.findMany({\n    where: { companyId },\n    include: {\n      shareCertificates: {\n        where: { status: \"OUTSTANDING\" },\n        include: { shareClass: true },\n      },\n      optionGrants: {\n        where: { status: { in: [\"ACTIVE\", \"PARTIALLY_EXERCISED\"] } },\n        include: { exercises: true, vestingSchedule: true },\n      },\n      convertibles: {\n        where: { status: \"OUTSTANDING\" },\n      },\n    },\n  });\n\n  const fullyDiluted = await getFullyDilutedBreakdown(companyId);\n  const totalOutstanding = await getTotalOutstandingShares(companyId);\n\n  return stakeholders.map((s) => {\n    // Outstanding shares from certificates\n    const outstandingShares = s.shareCertificates.reduce((sum, c) => {\n      const conversionRatio =\n        c.shareClass.type === \"PREFERRED\"\n          ? Number(c.shareClass.conversionRatio)\n          : 1;\n      return sum + Math.floor(c.quantity * conversionRatio);\n    }, 0);\n\n    // Options (remaining unexercised)\n    const optionShares = s.optionGrants.reduce((sum, g) => {\n      const exercised = g.exercises.reduce((e, ex) => e + ex.sharesExercised, 0);\n      return sum + (g.originalQuantity - exercised - g.expiredQuantity);\n    }, 0);\n\n    // Convertible shares estimate\n    let convertibleShares = 0;\n    for (const conv of s.convertibles) {\n      const principal = Number(conv.principal);\n      const accrued =\n        conv.type === \"CONVERTIBLE_NOTE\" ? calculateAccruedInterest(conv) : 0;\n      const totalAmount = principal + accrued;\n      if (conv.valuationCap) {\n        const cap = Number(conv.valuationCap);\n        const impliedPrice = cap / fullyDiluted.total || 1;\n        convertibleShares += Math.floor(totalAmount / impliedPrice);\n      }\n    }\n\n    const fullyDilutedShares = outstandingShares + optionShares + convertibleShares;\n\n    // Total invested\n    const totalInvested =\n      s.shareCertificates.reduce((sum, c) => sum + Number(c.cashPaid), 0) +\n      s.convertibles.reduce((sum, c) => sum + Number(c.principal), 0);\n\n    return {\n      stakeholderId: s.id,\n      stakeholderName: s.name,\n      stakeholderType: s.type,\n      outstandingShares,\n      fullyDilutedShares,\n      outstandingPercent:\n        totalOutstanding > 0 ? outstandingShares / totalOutstanding : 0,\n      fullyDilutedPercent:\n        fullyDiluted.total > 0 ? fullyDilutedShares / fullyDiluted.total : 0,\n      totalInvested,\n    };\n  });\n}\n\nexport async function getOwnershipByShareClass(\n  companyId: string\n): Promise<ShareClassOwnership[]> {\n  const shareClasses = await prisma.shareClass.findMany({\n    where: { companyId },\n    include: {\n      shareCertificates: {\n        where: { status: \"OUTSTANDING\" },\n      },\n    },\n  });\n\n  const fullyDiluted = await getFullyDilutedBreakdown(companyId);\n  const totalOutstanding = await getTotalOutstandingShares(companyId);\n\n  return shareClasses.map((sc) => {\n    const outstandingShares = sc.shareCertificates.reduce(\n      (sum, c) => sum + c.quantity,\n      0\n    );\n\n    // For fully diluted, convert preferred to common equivalent\n    const conversionRatio =\n      sc.type === \"PREFERRED\" ? Number(sc.conversionRatio) : 1;\n    const fullyDilutedShares = Math.floor(outstandingShares * conversionRatio);\n\n    return {\n      shareClassId: sc.id,\n      shareClassName: sc.name,\n      shareClassType: sc.type,\n      outstandingShares,\n      fullyDilutedShares,\n      outstandingPercent:\n        totalOutstanding > 0 ? outstandingShares / totalOutstanding : 0,\n      fullyDilutedPercent:\n        fullyDiluted.total > 0 ? fullyDilutedShares / fullyDiluted.total : 0,\n    };\n  });\n}\n\n// ============================================\n// VESTING CALCULATIONS\n// ============================================\n\nexport function generateVestingPeriods(\n  originalQuantity: number,\n  schedule: {\n    vestingStartDate: Date;\n    cliffMonths: number;\n    cliffPercentage: number | { toNumber(): number };\n    totalPeriods: number;\n    periodUnit: \"MONTHLY\" | \"QUARTERLY\" | \"ANNUALLY\";\n  },\n  terminationDate?: Date | null\n): VestingPeriodData[] {\n  const periods: VestingPeriodData[] = [];\n  const vestingStart = startOfDay(new Date(schedule.vestingStartDate));\n  const cliffPercent = Number(schedule.cliffPercentage);\n\n  // Calculate cliff date and shares\n  const cliffDate = addMonths(vestingStart, schedule.cliffMonths);\n  const cliffShares = Math.floor(originalQuantity * cliffPercent);\n  const remainingShares = originalQuantity - cliffShares;\n  const remainingPeriods = schedule.totalPeriods - schedule.cliffMonths;\n  const sharesPerPeriod =\n    remainingPeriods > 0 ? Math.floor(remainingShares / remainingPeriods) : 0;\n\n  // Handle termination before cliff\n  if (terminationDate && isBefore(startOfDay(terminationDate), cliffDate)) {\n    // If terminated on cliff date, cliff still vests\n    if (!isSameDay(startOfDay(terminationDate), cliffDate)) {\n      return []; // Terminated before cliff - no vesting\n    }\n  }\n\n  // Cliff period (period 0)\n  periods.push({\n    periodNumber: 0,\n    vestingDate: cliffDate,\n    sharesVested: cliffShares,\n    cumulativeVested: cliffShares,\n  });\n\n  // Monthly/quarterly/annual periods after cliff\n  let cumulative = cliffShares;\n  const periodMonths =\n    schedule.periodUnit === \"MONTHLY\"\n      ? 1\n      : schedule.periodUnit === \"QUARTERLY\"\n      ? 3\n      : 12;\n\n  for (let i = 1; i <= remainingPeriods; i++) {\n    const periodDate = addMonths(cliffDate, i * periodMonths);\n\n    // Check if terminated before this period\n    if (terminationDate && isAfter(periodDate, startOfDay(terminationDate))) {\n      break;\n    }\n\n    // Last period gets remainder to handle fractional rounding\n    const isLastPeriod = i === remainingPeriods;\n    const vested = isLastPeriod\n      ? remainingShares - sharesPerPeriod * (remainingPeriods - 1)\n      : sharesPerPeriod;\n\n    cumulative += vested;\n\n    periods.push({\n      periodNumber: i,\n      vestingDate: periodDate,\n      sharesVested: vested,\n      cumulativeVested: cumulative,\n    });\n  }\n\n  return periods;\n}\n\nexport async function getVestedQuantity(\n  grantId: string,\n  asOfDate: Date = new Date()\n): Promise<number> {\n  const grant = await prisma.optionGrant.findUnique({\n    where: { id: grantId },\n    include: { vestingSchedule: true },\n  });\n\n  if (!grant || !grant.vestingSchedule) return 0;\n\n  const periods = generateVestingPeriods(\n    grant.originalQuantity,\n    {\n      vestingStartDate: grant.vestingSchedule.vestingStartDate,\n      cliffMonths: grant.vestingSchedule.cliffMonths,\n      cliffPercentage: grant.vestingSchedule.cliffPercentage,\n      totalPeriods: grant.vestingSchedule.totalPeriods,\n      periodUnit: grant.vestingSchedule.periodUnit,\n    },\n    grant.terminationDate\n  );\n\n  // Find the last period that has vested as of the given date\n  const asOf = startOfDay(asOfDate);\n  let vested = 0;\n  for (const period of periods) {\n    if (!isAfter(startOfDay(period.vestingDate), asOf)) {\n      vested = period.cumulativeVested;\n    }\n  }\n\n  return vested;\n}\n\nexport async function getExercisedQuantity(grantId: string): Promise<number> {\n  const exercises = await prisma.optionExercise.findMany({\n    where: { optionGrantId: grantId, status: { in: [\"APPROVED\", \"COMPLETED\"] } },\n  });\n  return exercises.reduce((sum, ex) => sum + ex.sharesExercised, 0);\n}\n\nexport async function getExercisableQuantity(\n  grantId: string,\n  asOfDate: Date = new Date()\n): Promise<number> {\n  const vested = await getVestedQuantity(grantId, asOfDate);\n  const exercised = await getExercisedQuantity(grantId);\n  return Math.max(0, vested - exercised);\n}\n\nexport function getVestingDescription(schedule: {\n  cliffMonths: number;\n  cliffPercentage: number | { toNumber(): number };\n  totalPeriods: number;\n  periodUnit: \"MONTHLY\" | \"QUARTERLY\" | \"ANNUALLY\";\n}): string {\n  const cliffPercent = Math.round(Number(schedule.cliffPercentage) * 100);\n  const cliffYears = schedule.cliffMonths / 12;\n  const totalYears = schedule.totalPeriods / 12;\n  const periodName = schedule.periodUnit.toLowerCase();\n\n  if (schedule.periodUnit === \"MONTHLY\") {\n    return `1/${schedule.totalPeriods} ${periodName} vesting with a ${cliffYears} year cliff (${cliffPercent}%)`;\n  }\n  return `${totalYears}-year ${periodName} vesting with a ${cliffYears}-year cliff`;\n}\n\n// ============================================\n// INTEREST CALCULATIONS (Convertible Notes)\n// ============================================\n\nexport function calculateAccruedInterest(\n  convertible: Pick<\n    Convertible,\n    \"type\" | \"principal\" | \"interestRate\" | \"interestStartDate\"\n  >,\n  asOfDate: Date = new Date()\n): number {\n  if (convertible.type !== \"CONVERTIBLE_NOTE\") return 0;\n  if (!convertible.interestRate || !convertible.interestStartDate) return 0;\n\n  const principal = Number(convertible.principal);\n  const rate = Number(convertible.interestRate);\n  const startDate = new Date(convertible.interestStartDate);\n  const daysElapsed = differenceInDays(asOfDate, startDate);\n\n  if (daysElapsed <= 0) return 0;\n\n  // Simple interest: principal * rate * (days / 365)\n  return principal * rate * (daysElapsed / 365);\n}\n\nexport function getTotalConvertibleAmount(\n  convertible: Pick<\n    Convertible,\n    \"type\" | \"principal\" | \"interestRate\" | \"interestStartDate\"\n  >,\n  asOfDate: Date = new Date()\n): number {\n  const principal = Number(convertible.principal);\n  const accrued = calculateAccruedInterest(convertible, asOfDate);\n  return principal + accrued;\n}\n\n// ============================================\n// AGGREGATE METRICS\n// ============================================\n\nexport async function getCapTableMetrics(companyId: string) {\n  const [fullyDiluted, equityPlans, certificates, convertibles] =\n    await Promise.all([\n      getFullyDilutedBreakdown(companyId),\n      prisma.equityPlan.findMany({ where: { companyId } }),\n      prisma.shareCertificate.findMany({\n        where: { companyId, status: \"OUTSTANDING\" },\n      }),\n      prisma.convertible.findMany({\n        where: { companyId, status: \"OUTSTANDING\" },\n      }),\n    ]);\n\n  const availableShares = equityPlans.reduce(\n    (sum, p) => sum + p.availableShares,\n    0\n  );\n\n  const amountRaised =\n    certificates.reduce((sum, c) => sum + Number(c.cashPaid), 0) +\n    convertibles.reduce((sum, c) => sum + Number(c.principal), 0);\n\n  return {\n    fullyDilutedShares: fullyDiluted.total,\n    fullyDilutedBreakdown: fullyDiluted,\n    availableShares,\n    amountRaised,\n  };\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11]}